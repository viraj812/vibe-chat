var formidable = require('formidable');
var path = require('path');
var fs = require('fs');

exports.uploadImage = function (req, res) 
{
    var form = new formidable.IncomingForm();
    form.parse(req, function (err, fields, files) 
    {
        var file = files.file;
        var tempPath = file.path;
        var targetPath = path.resolve('./uploads/' + file.name);
        fs.rename(tempPath, targetPath, function (err) 
        {
            if (err) 
            {
                throw err;
            }
            return res.json({path: 'uploads/' + file.name});
        });
    });
};